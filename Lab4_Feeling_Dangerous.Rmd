---
title: "lab 4 Feeling Dangerous"
author: "Fin,Nahom,Chun,Jake"
date: "9/20/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
babies <- read_csv("https://raw.githubusercontent.com/ervance1/Sp2018-Data-Science-repo/master/babies2a.dat")
babies <- rename(babies, bwtoz = `bwt/oz`)
babies <- na.omit(babies)


```
# Team Section

### Overall Questions 

#### Does smoking increase the rate of premature births in pregnant women?

#### Does smoking in pregnant mother cause overall lower birth weights for newborns at every gestitational age?

### Why it Matters
A mothers habits and decisions during pregancy impact her child long after birth. Understanding the relationships between smoking and pregancy are very important to insure people can make educated descisons to protect their childern. The surgeon general released his report over twenty years ago and with new tecnology we can better understand the data that he was presented with to evaluate his claims. We will be able to use our conclusions to help the new surgeon general. This will make sure people are educated and help them make descisons that do not impact their childern.

### Team Plots
```{r}
ggplot(data=babies)+
  geom_bar(mapping=aes(x=Premature), fill="blue", color="black")+
  facet_wrap(~smoke)+
  labs(
    title="Relationship between Smoking among Pregeant Woman and Premature Birth"
  )+
  ylab("Count")+
  xlab("Premature")+
  theme_light()

ggplot(data=babies)+
  geom_point(mapping=aes(y=bwtoz, x=gestation, color=smoke))+
  facet_grid(~smoke)+
  labs(
    title="Distribution of Gestation length vs. Birthweight for Non-smokers and Smokers"
  )+
  ylab("Birth Weight (Ounces)")+
  xlab("Gestation Length")+
  theme_minimal()

```

### Conclusions
From these two plots it can be concluded that mothers who smoke during pregancy are more likely to have premature birth as well as smaller babies in general. For mothers who smoked during pregancy it can be seen that they have a higher perctange of premature births than non-smokers even though the overall count is slightly smaller which means it makes up a larger percentage of the population. Looking at birthweight it can be easily seen that woman who smoke in general have babies that weigh less. This is true regardles of the gesation length as the babies that non-smokers have even prematurally will generally weigh more than those of smokers. As a team we agree with the surgeon generals original recommendations

### Recommendations
Our group recommends that the new surgeon general affirms previous conclusions on smoking and pregnancy. They should make a plan to increase the general education of mothers and fathers so they are aware of the dangers of smoking while pregnant. We also think new data should be collected as all the data being analyzed in this report was over 20 years old and may be less applicable to current populations. It seems unlikely that new data would change any of the conclusions in this report however it would increase credibility and relevance. Along with this new data collection we also think the CDC should collect data related to vaping and pregnancy as it is related issue that has seen little study.

### Preliminary Question and Awnser
Which variables are simmilar for smokers and non-smokers? Which are different?
   - Income and parity have about the same proportions of smoker and non-smokers. Education, race, and marital status       all have different proportions of smokers. It is important to know thes background variables have different             proptions of somokers and non-smokers becuase that has a great effect on the premature and mature births. This could show simpsons paradox.
   
```{r cars}
babies <- na.omit(babies)

married <- babies %>% filter(marital == 1)
married <- married %>% mutate(smoke = as.character(smoke))

p <-ggplot(data = married) +
  geom_bar(mapping = aes(x = smoke ,fill = smoke), color = "black", position = "dodge") +
  labs(
    title = "Married",
    caption = "0 = Never smoked | 1 = Somokes now"
  )
p + scale_fill_brewer(palette="Reds")

divorced <- babies %>% filter(marital == 2)
divorced <- divorced %>% mutate(smoke = as.character(smoke))
p <-ggplot(data = divorced) +
  geom_bar(mapping = aes(x = smoke ,fill = smoke), color = "black", position = "dodge") +
  labs(
    title = "Legally Sperated",
    caption = "0 = Never smoked | 1 = Somokes now"
  )
p + scale_fill_brewer(palette="Blues")

```


# Individual Section 

#### Jake

### Individual Questions

### Plots 

```{r pressure, echo=FALSE}
cor(babies$Premature, babies$smoke)
```

```{r cars}
babies <- na.omit(babies)
babies <- babies %>% filter(Premature == 1)
babies <- babies %>% mutate(smoke = as.character(smoke))
p <-ggplot(data = babies) +
  geom_bar(mapping = aes(x = smoke ,fill = smoke), color = "black", position = "dodge") +
  labs(
    title = "Premature Babies",
    caption = "0 = Never smoked | 1 = Somokes now"
  )
p + scale_fill_brewer(palette="Blues")
```

```{r pressure, echo=FALSE}
babies <- na.omit(babies)
mature <- babies %>% filter(Premature == 0)
mature <- mature %>% mutate(smoke = as.character(smoke))
p <-ggplot(data = mature) +
  geom_bar(mapping = aes(x = smoke ,fill = smoke), color = "black", position = "dodge") +
  labs(
    title = "Mature Babies",
    caption = "0 = Never smoked | 1 = Smokes now"
  )
p + scale_fill_brewer(palette="Blues")
```

### Findings
In my personal investigation, I found out the group of women who had premature babies had a higher count of "smokes now". For the 92 women who had a premature baby, 48 of them smoke now, while 44 of them have never smoked. For the group of women that had mature babies, a significantlly higher percentage of them have never smoked. There was about 415 women who had a mature baby and about 245 of them have never smoked and about 170 of them smoke now. With the proportionatly higher amount of smokers in the premature group of women, it's safe to say that there is a positive correlation between having a premature baby and smoking cigarettes, though, a very weak correlation of just 0.0877491. With that being said, I would recommend that much more data is collected before making the conclusion that smoking cigarettes increases the liklihood for a women to have a premature baby. I also found that married women have a larger proportion if women who never smoke, whereas legally seperated women have a higher proportion of smokers. This plot is in the preliminary question section.

### Contributions
For this lab I looked into the realtionship between premature babies and the smoking tendencies of mothers. In doing this I made sure to use unique geom bar functions where I investigated new mapping techinques. I was able to mutate the data and create seperated graphs for premature babies and the mature babies. In doing this I came across the problem wiith the position-"dodge"" and fill within the bar charts. This was super frustraing for the split side-by-side bar charts. I was able to use new colors and borders in my graphs to make them more aesthetically pleasing. I wasn't sure how to do this for the previous lab so it felt nice to implement that feature into these plots. In addition, I was able to show my team how to use those features. I also showed them some shortcuts with commenting, running code, and useful aspects within the console and manipulating datasets. I also anwsered the preliminary question, brainstormed for team plots, commmunicated with my team over text to ensure diverse functions and fufillment of requirements. Lastly, I put the r markdown together and knited te final piece and turned it in.


----------------------------------

#### Fin Carlson

### Individual Questions
Is their a relationship between smoking and total number of births including fetal death?

Is their a relationship between a mothers education level and if she smokes while pregeant?

### Plots 
```{r}
ggplot(data=babies)+
  geom_jitter(mapping=aes(y=parity, x=mage, color=smoke))+
  theme_bw()+
  labs(
    title="Mothers Age vs. Number of births for Non-smokers and Smokers"
  )+
  ylab("Parity")+
  xlab("Mothers Age")

cor(babies$parity, babies$smoke)

ggplot(data=babies)+
  geom_smooth(mapping=aes(x=med, y=ded))+
  facet_wrap(~smoke)+
labs(
    title="Mothers Education vs. Fathers Education for Non-smokers and Smokers"
  )+
  ylab("Mothers Education")+
  xlab("Fathers Education")

ggplot(data=babies)+
  geom_jitter(mapping=aes(x=med, y=ded, alpha=smoke))+
  theme_minimal()+
labs(
    title="Mothers Education vs. Fathers Education for Non-smokers and Smokers"
  )+
  ylab("Mothers Education")+
  xlab("Fathers Education")

cor(babies$med,babies$smoke)
cor(babies$ded,babies$smoke)
cor(babies$med,babies$ded)

```


### Findings
In investigating the relationship between parity, the total number of births including fetal deaths, and whether a mother smoked I found their to be no relationship. The graph I generated to answer this showed little correlation as parity was highly affected by the mothers age but smoking's effects where unnoticeable. Calculating the correlation between parity and smoking came out to .04 and so I concluded my investigation on these variables. In looking at the effect of education on smoking I saw a much clearer picture that indicated education level  was positively correlated with smoking. It also showed a positive correlation between father and mother education level. Using a dot plot I explored this relationship closer and it can be seen that there is a clustering of data points for non smokers at an education level of 5. The opposite clustering can be seen at an education level of 2 as there is a large amount of smokers. Calculating the correlations for education level and smoking gives -.22 which indicates that as education level goes up likelihood of smoking goes down. This correlation is fairly low but that can be explained by the fact that a fair amount of lower educated people did not smoke. It is important to note though that as education rose the amount of smokers drastically dropped so it can be concluded that smoking and education level are related.

### Contributions 
For this lab I started by creating a template for everyone in the team to use for our final document. I then looked into the relationship between smoking and parity as well as education level of the parents. In doing this I made sure to use unique geom functions in both jitter and smooth. I investigated themes for my graphs as well as general aesthics and used the facet function to better show the difference in groups. I also anwsered the why it matters section, conclusion, reccomandation, and created the two plots for our team.

----------------------------------------------------------------

#### Nahom Taye

### Individual Questions
Does the mother's income affect a newborn to be Premature?

### Plots
```{r, echo=FALSE, message=FALSE}
ggplot(babies, aes(mrace,inc))+
geom_boxplot(aes(mrace,inc))+
facet_wrap(~Premature)+
theme(legend.position = "top")+
ggtitle("Income vs Premature birth")
```

### Findings

While white women are the median for both of women that have exprienced Premature birth or have not, they have same income for the minimum and median income of those that either had premature birth or not, while there is a noticeable difference in the maximum income to those women that have exprienced premature birth and women that have not exprienced Prematuer birth have 1 more maximum point income differce from those that have exprineced Premature birth. This helps better understand that income affects Premature birth as women with high income can better her chances of prevent Premature birth.  


### Contributions

-----------------------------------


#### Chun

### Individual Question
Is mother's race affects Premature when she smokes.

### Plots 
```{r} 
babies$mrace <- as.factor(babies$mrace)
babies$Premature <- as.factor(babies$Premature)
babies$smoke <- as.factor(babies$smoke)
ggplot(babies)+
  geom_bar(mapping = aes(x=Premature, fill=smoke), position = "fill" )+
  facet_grid(~mrace)+
  ggtitle(" Smoking VS. Premature based on Mother's race ")
ggplot(babies)+
  geom_bar(mapping = aes(x=Premature, fill=smoke), position = "fill" )+
  facet_grid(~mrace)+
  ggtitle(" Smoking VS. Premature based on Mother's race ")
```
### Findings
From the graph we can see that some white females'(from chart 2, 3 and 4) and  mixed races females' babies where born early mainly becaused they were still smoking when they were pregnant.  However, for example, in chart 1 we see that none of the mothers were smoking but still had premature babies.  Also from chart 0-4, we can see that lots of white mothers were still smoking when they were pregnant and from chart 5 - 8, most of white(or rest of the white), black, mexican ,  and asia mothers were not smoking( or never smoked before).  However, it is really hard to say if it is smoking that caused the premature babies.
### Contributions
 I created a chart with geom_bar to show the relation between smoker and premature with mother's races effected.  I use color to seperated if they are smoker or not.  Although most white women smoke and rest of the mothers from other races don't smoke but it is really hard to tell if smoking cause premature babies.

