---
title: "Lab 5 Feeling Dangerous"
author: "Fin,Nahom,Chun,Jake"
date: "9/29/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(tidyverse)
# Load and view the data
milk <- read.csv("/Users/fin/Desktop/tidytuesday-master/data/2019/2019-01-29/state_milk_production.csv")
head(milk)

milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)
```
# Team Section

### Team Plot

```{r}
milkstate <- milk %>%
  filter(state %in% c('Colorado','Montana','New Mexico','Oregon','Wyoming')) %>%
  group_by(year, state) %>%
  as_tibble()


milk1 <- milk %>%
  group_by(year) %>%
  summarise(milk_million = mean(milk_million)) %>%      
  as_tibble()


ggplot(mapping= aes(x=year , y=milk_million))+
  geom_point(data=milkstate, aes(color=state))+
  geom_line(data=milk1)+
  ggtitle('Production of Milk in Western States compared to the National Average')+
  xlab('Year')+
  ylab('Milk Produced (Million lb)')
  
```

### Take Aways 
This plot shows that the chosen states typically produce less milk than the national average. It also shows that in general, milk production has risen over the years as the national average has seen steady increase. This does not mean all states saw equal changes in production as places like Wyoming and Montana are not suitable for large milk operations and have seen very little change. New Mexico on the other hand started at the same production level of the previously mentioned states and yet today it is double that of the national average. It would be interesting to further analyze the data for New Mexico and try to identify the reasons for the sharp increase. 

### Follow Up Questions
```{r}
SumUS=milk%>% group_by(year) %>%summarise(Sum=sum(milk_million))%>% as_tibble()
  NS1=arrange(SumUS, desc(Sum))
  head(NS1, 1)
  tail(NS1, 1)

milk2017 <- milk %>% filter(year == 2017)
SumState=milk2017%>% group_by(state) %>%summarise(milk_million)%>% as_tibble()
NS2=arrange(SumState, desc(milk_million))
head(NS2, 5)
tail(NS2, 5)
  
```

#### What year was the most milk produced in the United States?
2017

#### What year was the least milk  produced in the United States?
1975

#### In 2017, what 5 states produced the most milk?
California, Wisconsin, New York, Idaho, Texas

#### In 2017, what 5 states produced the least milk?
Alabama, Arkansas, Hawaii, Rhode Island, Alaska



# Individual Sections 

#### Jake

### Plots and Findings
Part 1
```{r}
milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)

milk_birth_year <- milk %>%
  filter(year == 1998)

ggplot(data= milk_birth_year, aes(x = milk_million)) +
  geom_density(fill = "#ff4d4d", alpha = 0.5)
  ggtitle('Distribution estimate of the the milk produced in 1998')+
  xlab('Milk Produced (Millions lb)')
```

Part 2
```{r}
summary(milk2000)
```
Part 3
```{r, echo=FALSE}
milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)

milk_birth_year <- milk %>%
  filter(year == 1998)

avrMilk <- milk_birth_year %>%
   summarise(Mean = mean(milk_million)) %>%
   as_tibble()
 avrMilk

medMilk <- milk_birth_year %>%
  summarise(Median = median(milk_million)) %>%
  as_tibble()
medMilk

maxMilk <- milk_birth_year %>%
  summarise(Max = max(milk_million)) %>%
  as_tibble()
maxMilk

minMilk <- milk_birth_year %>%
  summarize(Min = min(milk_million)) %>%
  as_tibble()
minMilk
```



### Contributions 

##### I, Jacob Boeckenstedt, first started by completing the individual section to get a better understanding of the data. After doing several practice problems in the lab, I was able to get a better understanding for tidying this data set, as well as manipulating the data set. I then mutated the data to create a new variable (milk produced per million pounds) and filtered for my birth year 1998. I did a density plot for the distribution of milk produced in 1998. I was able to provide clear titles and nice looking fill making it  simple and easy on the viewers eye. After completing my individual section, I helped create our team plot to show the milk production over the years for some of states we chose as a group. Additionally, I looked over the plots and provided some of my key takeaways for the team. Finally, before fin was about to submit or final lab markdown, I added echo=FALSE in each of the indivisual sections containing the average/median summaries. This took away tedious code that doesn't need to be seen.

----------------------------------

#### Fin Carlson

### Plots and Findings
Part 1
```{r}
milk2000 <- milk %>%
  filter(year == 2000)

ggplot(data= milk2000, aes(x=region , y=milk_million, fill=region))+
  geom_bar(stat="identity")+
  ggtitle('Pounds of Milk by Region for the Year 2000')+
  xlab('Region')+
  ylab('Milk Produced (Million lb)')+
  scale_fill_discrete(name="Region") +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```


Part 2
```{r}
summary(milk2000)
```


Part 3
```{r, echo=FALSE}
milk_mean <- milk2000 %>%
      group_by(state) %>%
      summarise(mean_milk = mean(milk_million)) %>%      
    as_tibble()
milk_mean

median_milk <- milk2000 %>%
  group_by(state) %>%
  summarise(milk_median = median(milk_million)) %>%
  as_tibble()
median_milk

max_milk <- milk2000 %>%
  group_by(year) %>%
  summarise(milk_max = max(milk_million)) %>%
  as_tibble()
max_milk


min_milk <- milk2000 %>%
  group_by(year) %>%
  summarise(milk_min = min(milk_million)) %>%
  as_tibble()
min_milk

(max_min <- milk2000 %>%
  filter(milk_million==32245 | milk_million==13))
```
 
##### For my birth year (2000), I found the mean and median amounts of milk produced for each state as seen above and used the summarise function for both max and min to find that California produced the most and Alaska the least. My code for determining this is a little messy and could likely be cleaned into one step. I would still get the same answer either way as I first checked to see what the largest and smallest values were and then filtered by those values to find the state. I plotted my graph using the regions to show the overall difference on a broad scale in milk production around the country.

### Contributions 
##### For this lab I first started by completing the individual section to get a better understanding of the data through EDA. After completing my individual section I created our team plot to show the milk production over the years for the 5 states we chose as a group. It took me a while to be able to add the line for the national average as this is the result of all states and as such is a different data set. Through this I learned how to combine two plots even if they don't have the same data. I then looked over the graph and provided some of my key takeaways. I was also responsible for compiling the final Markdown file and turning it in.

 

----------------------------------------------------------------

#### Nahom

### Plots and Findings 


Q.1
```{r}

milk2000 <- milk %>%
  filter(year == 2000)
  ggplot(data = milk2000, aes( x= milk_million)) +
  geom_dotplot()
  ggtitle('Milk produced in the year 2000')
```

Q.2
```{r}
summary(milk2000)
```

Q.3

```{r}
summary= milk2000 %>% group_by(state)%>%
summarise(
            median = median(milk_produced),
            average = mean(milk_produced), 
            tot_milk = sum(milk_produced))%>%
as_tibble()
arrange(summary,desc(tot_milk))
```

### Contributions
##### For my birth year, I created a data frame using "as_tibble" function after I filtered my birth year ,2000, and calculated the median, mean/average and sum as shown above and arragned it by state and the sum in my table which showed me that California produced the most milk in pounds while Alask Produced the least amount of milk.



-----------------------------------


#### Chun


### Plots and Findings   
```{r}
milk1995 <- milk %>%
  filter(year == 1995)
```
1st
```{r}
  ggplot(data = milk1995, aes(x = milk_million)) +
  geom_histogram(bins = 20) + 
  ggtitle('Histogram of milk produced in 1995 by state')
```
2nd
```{r}
summary(milk1995)
```
3rd
```{r, echo=FALSE}
Summarize=milk %>% group_by(state) %>%
  summarise(Med = median(milk_million), Avg = mean(milk_million), Sum=sum(milk_million)) %>%
  as_tibble()
arrange(Summarize, desc(Sum))
```

### Contributions
##### I completed my individual section and came up with code to answer the team questions.
 
 

