---
title: "lab 7 Feeling Dangerous"
author: "Fin,Chun,Jake"
date: "10/13/2019"
output: html_document
---

```{r setup, include=FALSE}

```

### Introduction

The data being worked with in this report was obtained from the UC Irvine Machine Learning Repo. and shows the electricity use for a household in France over many years. The data contained many NA values and they were left in the data for the analysis and treated as data points because they little to no noticeable effect on the voltage variable which was primarily used.

# Team Section
All of us eliminate the the missing data set just by using na.rm=TRUE when we are calculating the mean fro summarise.
Jake's question is about if this house hold take a vaction monthly. This findings could help to save more energy while people are on vacation. By doing so, Jake created a Histogram for Global_active_power while this household is out of town.
Fin's question is about if the electricity use differently by seasons.  This findings especially helps the power company to calculate and analysis the overuse electricity during winter time. By doing so, Fin seperate all the data by seasons. And then, he calculated the average of Voltage for all four seasons.
Chun's question is about if the household would rather stay at home or go out for dinner during holiday. This findings can help those restaurant around that area to analysis if there will be any people want to go out for food during holidays. By doing so, Chun calculated the average of Voltage in kitchen during holidays at night by hours and compare it to the everyday life at night.
Nahom's question is about  the average energy consumption vary monthly. By doing so, Nahom showed the point plot(month vs mean voltage uses). And the result showed that their is a rather high electricity uses in Dec.


# Individual Section 

#### Jake

### Individual Question
What month did the family take a vaction?
### Plots 
```{r, include=FALSE}
library(tidyverse)
file_path <- "/Users/jacobboeckenstedt/Desktop/Data Science/Week 7/household_power_consumption.txt"

file_path

electricity_data <- read_delim(file = file_path, delim=';', na = c('', '?'),
                    col_types = cols(
                      Date = col_date(format="%d/%m/%Y"),
                      Time = col_time(format="%H:%M:%S"),
                      Global_active_power = col_double(),
                      Global_reactive_power = col_double(),
                      Voltage = col_double(),
                      Global_intensity = col_double(),
                      Sub_metering_1 = col_double(),
                      Sub_metering_2 = col_double(),
                      Sub_metering_3 = col_double()
                    ))
#ggplot(electricity_data) + geom_histogram(aes(Voltage))
#ggplot(electricity_data) + geom_point(aes(Date, Voltage))

electricity_data <- electricity_data %>% mutate(year=substr(Date,1,4), month=substr(Date, 6,7), day=substr(Date, 9,10))

electricity_data <- electricity_data %>% mutate(hour=substr(Time,1,2), minute=substr(Time, 4,5), second=substr(Time, 7,8))

electricity_data <- electricity_data %>% mutate( day=as.integer(day),
                           month=as.integer(month),
                           year=as.integer(year),
                           hour=as.integer(hour),
                           minute=as.integer(minute),
                           second=as.integer(second))

out_of_town <- electricity_data %>% filter(Global_active_power < 0.1)

data_by_month <- electricity_data %>% select(month, Global_active_power) %>% 
  group_by(month) %>% summarise(mean.active=mean(Global_active_power, na.rm=TRUE))

```

### Plots 

```{r}
p <- ggplot(out_of_town) + geom_histogram(aes(Global_active_power)) + facet_wrap(~month)+
  ggtitle('Histograms of each Month with Active Power Less than 0.1') +
  xlab('Global Active Power')
p + scale_color_grey()+scale_fill_grey() +
  theme_classic()
```

### Findings and Contributions
I first started by tidying the data and looking at a few simple graphs to see basic reltionship. I realized that a lot of the questions I was brainstorming, I already knew the answer to. For example, what season used the most energy? So I asked the question: When did the family go on vacation? I found that this happend in the month of August becuase August has the highest fequency of low Global Active Power rates. To go further I would break down August by day to see the exact time period or week when the family was not home and on vaction. This question is important to ask because these findings could help the family save more energy while they are on vacation. Energy rates may be higher than expected while being absent from the house.

----------------------------------

#### Fin Carlson

### Individual Question
How does electricty use vary by season?
```{r}
Season <- c("Winter", "Spring", "Summer", "Fall")
Avg_Electricty <- c(242,241,240,241 )
Electricty_dataframe <- data.frame(Season, Avg_Electricty)
Electricty_dataframe

```

Which season is most likely to use more than the expected amount of power?
```{r}
Greater_than_data <- c("Winter", "Spring", "Summer", "Fall")
Greater_than_prob <- c(.630, .483, .397, .473)
Greater_than_dataframe <- data.frame(Greater_than_data, Greater_than_prob)
Greater_than_dataframe

```


### Work

```{r}
library(tidyverse)
macpath <- "/Users/fin/Desktop/Data_Science/household_power_consumption.txt"
data1 <- read_delim(file = macpath, delim=';', na = c('', '?'),
                    col_types = cols(
                      Date = col_date(format="%d/%m/%Y"),
                      Time = col_time(format="%H:%M:%S"),
                      Global_active_power = col_double(),
                      Global_reactive_power = col_double(),
                      Voltage = col_double(),
                      Global_intensity = col_double(),
                      Sub_metering_1 = col_double(),
                      Sub_metering_2 = col_double(),
                      Sub_metering_3 = col_double()
                    ))

ggplot(data1) + geom_histogram(aes(Voltage))
ggplot(data1) + geom_point(aes(Date, Voltage))

data1 <- data1 %>% mutate(year=substr(Date,1,4), month=substr(Date, 6,7), day=substr(Date, 9,10))

data1 <- data1 %>% mutate(hour=substr(Time,1,2), minute=substr(Time, 4,5), second=substr(Time, 7,8))

data1 <- data1 %>% mutate( day=as.integer(day),
                           month=as.integer(month),
                           year=as.integer(year),
                           hour=as.integer(hour),
                           minute=as.integer(minute),
                           second=as.integer(second))
library(lubridate)
data1 <- data1 %>% mutate(datetime=make_datetime(year, month, day, hour, minute, second))

#### 

###

data_by_month <- data1 %>% select(month, Voltage) %>% 
  group_by(month) %>% summarise(mean.voltage=mean(Voltage, na.rm=TRUE))


avg_volts <- data_by_month %>% summarise(total.voltage=mean(mean.voltage, na.rm =TRUE))
avg_volts


#####

winter_data <- data1 %>% filter(month==12 | month==1 | month==2)
winter_data

larger_than_winter <- winter_data %>% filter(Voltage>241)
larger_than_winter

winter_avg <- data_by_month %>% filter(month==12 | month==1 | month==2) %>% summarise(winter.avg.voltage=mean(mean.voltage, na.rm =TRUE))
winter_avg

#######

summer_data <- data1 %>% filter(month==6 | month==7 | month==8)
summer_data

larger_than_summer <- summer_data %>% filter(Voltage>241)
larger_than_summer

summer_avg <- data_by_month %>% filter(month==6 | month==7 | month==8) %>% summarise(summer.avg.voltage=mean(mean.voltage, na.rm =TRUE))
summer_avg

#######

spring_data <- data1 %>% filter(month==3 | month==4 | month==5)
spring_data

larger_than_spring <- spring_data %>% filter(Voltage>241)
larger_than_spring

spring_avg <- data_by_month %>% filter(month==3 | month==4 | month==5) %>% summarise(spring.avg.voltage=mean(mean.voltage, na.rm =TRUE))
spring_avg

########

fall_data <- data1 %>% filter(month==9 | month==10 | month==11)
fall_data

larger_than_fall <- fall_data %>% filter(Voltage>241)
larger_than_fall

fall_avg <- data_by_month %>% filter(month==9 | month==10 | month==11) %>% summarise(fall.avg.voltage=mean(mean.voltage, na.rm =TRUE))
fall_avg

########

nrow(larger_than_winter) / nrow(winter_data)
nrow(larger_than_spring) / nrow(spring_data)
nrow(larger_than_summer) / nrow(summer_data)
nrow(larger_than_fall) / nrow(fall_data)


Greater_than_data <- c("Winter", "Spring", "Summer", "Fall")
Greater_than_prob <- c(.630, .483, .397, .473)
Greater_than_dataframe <- data.frame(Greater_than_data, Greater_than_prob)
Greater_than_dataframe

Season <- c("Winter", "Spring", "Summer", "Fall")
Avg_Electricty <- c(242,241,240,241 )
Electricty_dataframe <- data.frame(Season, Avg_Electricty)
Electricty_dataframe
```

### Plots 

```{r}
ggplot(data= Greater_than_dataframe, aes(x=Greater_than_data , y=Greater_than_prob))+
  geom_bar(stat="identity")+
  ggtitle('Probability that Voltage Use is Greater than Average By Season')+
  xlab('Season')+
  ylab('Probability')+
  theme(axis.ticks.x=element_blank())+
  theme_minimal()

```
 
### Findings

To generate my question I first started by tidying the data and looking at a few simple graphs that showed general relationships (geom_point and geom_histogram). These graphs showed general differences for each part of the year but the trend continued at the same time each year which led me to investigate seasonal use of electricity. I generated two questions and found the avg voltage use to be 241 across the entire year. I then calculated the average use for each season and found that winter had the highest average, slightly above the yearly average, at 242 volts. I further investigated this to find the probability that average voltage use was greater than the yearly average for each season. I then discovered that again winter had the highest probability of using more electricity with a probability of .63 which is significant as none of the other probabilities are greater than .5 showing a distinct jump in chance. This question is interesting because while it would seem obvious that seasonal factors such as weather would have an effect on heating and cooling thus increasing electricity use, it is unknown which season has the greatest effect and because the data comes from a foreign country my experience with their climate and seasonal variation is much different. These findings could benefit the family as they now know their electricity use is higher during the winter and as such they will be able to budget their finances to prepare for this or adapt and try to use less electricity. It could also benefit electricity companies as they would be able to plan for higher overall usage among their systems during winter time to prevent outages.



----------------------------------------------------------------


#### Chun

### Individual Question
Does this household likes to have  go outsides or just normal stay at home for the dinner during the holiday(new year, christmas and thanks giving)?

### Work 

```{r}
library(tidyverse)
IHEP = read_delim("household_power_consumption.txt", delim=';', na = c('', '?'),
                    col_types = cols(
                      Date = col_date(format="%d/%m/%Y"),
                      Time = col_time(format="%H:%M:%S"),
                      Global_active_power = col_double(),
                      Global_reactive_power = col_double(),
                      Voltage = col_double(),
                      Global_intensity = col_double(),
                      Sub_metering_1 = col_double(),
                      Sub_metering_2 = col_double(),
                      Sub_metering_3 = col_double()
                    ))
IHEP1 = IHEP%>%mutate(year=as.integer(substr(Date,1,4)), month=as.integer(substr(Date, 6,7)), day=as.integer(substr(Date, 9,10)), hour=as.integer(substr(Time, 1,2)))
NIGHT = IHEP1%>%filter(year==2009)%>%filter(hour>=18)%>%group_by(hour)
Night =NIGHT%>%filter(Sub_metering_1!="na")
NIGHT_cal = NIGHT%>%summarise(mean_kit_Volt=mean(Sub_metering_1, na.rm=TRUE))
christmas = NIGHT%>%filter(month==12)%>%filter(day==24)%>%group_by(hour)
christmas_cal = christmas%>%summarise(mean_chris_Volt = mean(Sub_metering_1, na.rm=TRUE))
new_year = NIGHT%>%filter(month==1)%>%filter(day==1)%>%group_by(hour)
new_year_cal=new_year%>%summarise(mean_new_Volt=mean(Sub_metering_1, na.rm = TRUE))
thanksgiving = NIGHT%>%filter(month==11)%>%filter(day==28)%>%group_by(hour)
thanksgiving_cal=thanksgiving%>%summarise(mean_thanks_Volt=mean(Sub_metering_1, na.rm = TRUE))
```

### Answer
##AVG
```{r}
NIGHT_cal
```
##New years
```{r}
new_year_cal
ggplot(new_year)+
  geom_smooth(aes(Time, Sub_metering_1))
```
From this data, we can see that they are not using the kitchen at all from 6-9 p.m.. We can  conclude that they are probabily not eating at home

##Christmas
```{r}
christmas_cal
ggplot(christmas)+
  geom_smooth(aes(Time, Sub_metering_1))
```
From this data, we can see that from 7-9 p.m. there are huge electricity used during that period which is way bigger than the average uses of electricity in the kitchen. We can conclude that this house hold is probabily throwing a party.

##thanksgiving
```{r}
thanksgiving_cal
ggplot(thanksgiving)+
  geom_smooth(aes(Time, Sub_metering_1))
```
From this data, we can see that form 8 -10 p.m, there is a higher electricity used then usual. But at the rest of the periods, the electricity uses is significantly low. We can guess that they are having a small party at 8-10 p.m. but then they went out for fun.

###Findings
I think this question is interesting is because although they are all holidays but this household treated them differently. We can see this differences from how they deal with the dinner time.  I work this out by finding the mean of every hour's electricity used at night during holiday compare to the everyday's night hour uses. I think restaurant will benefit from this analysis.
 
 ---------------------------------------------------------------
### Nahom

### Individual Question
How does the average energy consumption vary monthly?

### Plots  

```{r}
library(tidyverse)
path <- "/Users/olio/Downloads/Data Science 2019/lab 7/household_power_consumption.txt"


data1 <- read_delim(file = path, delim=';', na = c('', '?'),
                    col_types = cols(
                      Date = col_date(format="%d/%m/%Y"),
                      Time = col_time(format="%H:%M:%S"),
                      Global_active_power = col_double(),
                      Global_reactive_power = col_double(),
                      Voltage = col_double(),
                      Global_intensity = col_double(),
                      Sub_metering_1 = col_double(),
                      Sub_metering_2 = col_double(),
                      Sub_metering_3 = col_double()
                    ))  

data1 <- data1 %>% mutate(year=substr(Date,1,4), month=substr(Date, 6,7), day=substr(Date, 9,10))
data1 <- data1 %>% mutate(hour=substr(Time,1,2), minute=substr(Time, 4,5), second=substr(Time, 7,8))
data1 <- data1 %>% mutate( day=as.integer(day),
                           month=as.integer(month),
                           year=as.integer(year),
                           hour=as.integer(hour),
                           minute=as.integer(minute),
                           second=as.integer(second))

```

```{r}
library(lubridate)
data1 <- data1 %>% mutate(datetime=make_datetime(year, month, day, hour, minute, second))
data_by_month <- data1 %>% select(month, Voltage) %>% 
  
  group_by(month) %>% summarise(mean.voltage=mean(Voltage, na.rm=TRUE))
  ggplot(data_by_month)+ 
  geom_point(aes(month, mean.voltage))+
  scale_x_continuous(breaks=seq(1,12,1))
```

### Findings
Based on the graph we can say that Decmeber see the most energy use on average which makes sense due to the fact that its the beging of the winter season, while May is the month with the lowest energy consumption as it is the end of the spring it is logical that the house hold uses the least amount of energy in spring.


